# 🚀 快速开始指南

## 📋 功能聚合完成

所有功能已成功聚合到 **`整体日报数据.py`** 脚本中！

## 🎯 一键运行

### 在影刀RPA中

```python
# 只需运行这一个脚本
整体日报数据.py
```

### 功能包含

✅ **数据分析** - ERP订单明细 + 分销数据分析  
✅ **HTML报告** - 可视化销售报告生成  
✅ **EdgeOne部署** - 自动部署到腾讯云CDN（影刀环境优化）  
✅ **企业微信推送** - 报告摘要 + Web链接推送  

## 🤖 影刀环境优化

### 自动检测
- 🔍 自动检测影刀RPA环境
- 🛠️ 智能EdgeOne CLI路径查找
- ⚙️ 优化的环境变量配置

### 路径适配
```
影刀内置路径:
D:\软件\ShadowBot\nodejs\node_modules\.bin\edgeone.cmd

用户路径:
~\AppData\Roaming\npm\edgeone.cmd

系统路径:
C:\Program Files\nodejs\node_modules\.bin\edgeone.cmd
```

### 错误处理
- 📋 详细的错误诊断
- 💡 针对性解决建议
- 🔄 自动重试机制

## 📊 执行流程

```
🚀 启动脚本
    ↓
🤖 检测影刀环境
    ↓
📊 连接数据库获取数据
    ↓
🔄 数据清洗和分析
    ↓
📄 生成HTML报告
    ↓
🌐 EdgeOne云端部署
    ↓
📱 企业微信推送
    ↓
✅ 完成
```

## 📁 输出文件

### 本地文件
- `reports/销售日报_YYYY-MM-DD.html` - 完整报告
- `sales_analysis.log` - 执行日志

### 云端链接
- `https://edge.haierht.cn/销售日报_YYYY-MM-DD.html`

## ⚡ 快速验证

### 1. 检查环境
```bash
# 检查Python
python --version

# 检查EdgeOne CLI
edgeone --version
```

### 2. 运行脚本
```python
# 在影刀中直接运行
整体日报数据.py
```

### 3. 查看结果
- 📋 控制台输出
- 📄 本地HTML文件
- 🌐 云端访问链接
- 📱 企业微信消息

## 🔧 故障排除

### EdgeOne CLI问题
```bash
# 手动安装
npm install -g @tencent/edgeone-cli
```

### 网络问题
- 检查防火墙设置
- 确认代理配置
- 验证DNS解析

### 权限问题
- 确保文件写入权限
- 检查API Token有效性
- 验证数据库连接

## 📞 支持

如遇问题，请检查：
1. 📋 `sales_analysis.log` 日志文件
2. 🌐 网络连接状态
3. 🔑 EdgeOne API Token
4. 💾 数据库连接

---

**🎉 恭喜！现在您只需要运行一个脚本就能完成所有任务！**