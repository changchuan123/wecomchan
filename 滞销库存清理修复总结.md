# æ»žé”€åº“å­˜æ¸…ç†è„šæœ¬ä¿®å¤æ€»ç»“

## ðŸ”§ ä¿®å¤çš„é—®é¢˜

### 1. **å†…å®¹åˆ†æ®µé—®é¢˜**
**é—®é¢˜æè¿°**: ä¸åŒå“ç±»ä¿¡æ¯è¢«åˆå¹¶åœ¨ä¸€èµ·å‘é€ï¼Œæ²¡æœ‰æŒ‰å“ç±»åˆ†åˆ«å‘é€
**ä¿®å¤æ–¹æ¡ˆ**: 
- æ¢å¤æŒ‰å“ç±»åˆ†åˆ«å‘é€çš„é€»è¾‘
- æ¯ä¸ªå“ç±»ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯å‘é€
- æ¯ä¸ªå“ç±»å‘é€ç»™å¯¹åº”çš„ç”¨æˆ·ç»„

### 2. **æ—¥æŠ¥å–æ•°é€»è¾‘é”™è¯¯**
**é—®é¢˜æè¿°**: æ—¥æŠ¥æ•°æ®æŒ‰ç…§æœˆç´¯è®¡å–æ•°ï¼Œåº”è¯¥æ˜¯æ˜¨å¤©ä¸€å¤©çš„æ•°æ®
**ä¿®å¤æ–¹æ¡ˆ**:
```python
# ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
df_erp = df_all[
    (df_all[DATE_COL] >= month_start) & 
    (df_all[DATE_COL] <= yesterday)
].copy()

# ä¿®å¤åŽï¼ˆæ­£ç¡®ï¼‰
df_erp = df_all[
    (df_all[DATE_COL].dt.date == yesterday.date())
].copy()
```

### 3. **æœˆæŠ¥æ ‡é¢˜é‡å¤**
**é—®é¢˜æè¿°**: æœˆæŠ¥æ ‡é¢˜ä¸­æ—¥æœŸä¿¡æ¯é‡å¤æ˜¾ç¤º
**ä¿®å¤æ–¹æ¡ˆ**:
```python
# ä¿®å¤å‰ï¼ˆé‡å¤ï¼‰
report_title = f"\nðŸ“¦ æ»žé”€åº“å­˜æ¸…ç†æœˆæŠ¥\nðŸ“… æ•°æ®æœˆä»½: {report_date}ï¼ˆ{month_start.strftime('%Y-%m-%d')}è‡³{yesterday.strftime('%Y-%m-%d')}ï¼‰\n"

# ä¿®å¤åŽï¼ˆç®€åŒ–ï¼‰
report_title = f"\nðŸ“¦ æ»žé”€åº“å­˜æ¸…ç†æœˆæŠ¥\nðŸ“… æ•°æ®æœˆä»½: {report_date}\n"
```

### 4. **é‡å¤å‘é€é—®é¢˜**
**é—®é¢˜æè¿°**: åŒæ ·çš„å†…å®¹è¢«å‘é€å¤šæ¬¡
**ä¿®å¤æ–¹æ¡ˆ**:
- ä¿®å¤å‘é€é€»è¾‘ï¼Œç¡®ä¿æ¯ä¸ªç”¨æˆ·åªæ”¶åˆ°ä¸€æ¬¡æ¶ˆæ¯
- æ·»åŠ å‘é€çŠ¶æ€è¿½è¸ª
- æŒ‰å“ç±»åˆ†åˆ«å‘é€ï¼Œé¿å…åˆå¹¶å‘é€

## ðŸ“‹ ä¿®å¤åŽçš„é€»è¾‘

### **æ—¥æŠ¥è„šæœ¬é€»è¾‘**
1. **æ•°æ®ç­›é€‰**: åªå–æ˜¨å¤©ä¸€å¤©çš„æ•°æ®
2. **å“ç±»å¤„ç†**: æŒ‰å“ç±»åˆ†åˆ«ç”ŸæˆæŠ¥å‘Š
3. **ç”¨æˆ·åŒ¹é…**: æ¯ä¸ªå“ç±»å‘é€ç»™å¯¹åº”çš„ç”¨æˆ·ç»„
4. **å‘é€æŽ§åˆ¶**: æ¯ä¸ªå“ç±»å•ç‹¬å‘é€ï¼Œé¿å…é‡å¤

### **æœˆæŠ¥è„šæœ¬é€»è¾‘**
1. **æ•°æ®ç­›é€‰**: å–å½“æœˆ1å·åˆ°T-1çš„ç´¯è®¡æ•°æ®
2. **æ ‡é¢˜ç®€åŒ–**: åŽ»æŽ‰é‡å¤çš„æ—¥æœŸä¿¡æ¯
3. **å“ç±»å¤„ç†**: æŒ‰å“ç±»åˆ†åˆ«ç”ŸæˆæŠ¥å‘Š
4. **ç”¨æˆ·åŒ¹é…**: æ¯ä¸ªå“ç±»å‘é€ç»™å¯¹åº”çš„ç”¨æˆ·ç»„
5. **å‘é€æŽ§åˆ¶**: æ¯ä¸ªå“ç±»å•ç‹¬å‘é€ï¼Œé¿å…é‡å¤

## âœ… ä¿®å¤æ•ˆæžœ

### **è§£å†³çš„é—®é¢˜**
- âœ… æ¢å¤äº†æŒ‰å“ç±»åˆ†åˆ«å‘é€çš„é€»è¾‘
- âœ… ä¿®å¤äº†æ—¥æŠ¥å–æ•°é€»è¾‘ï¼ˆåªå–æ˜¨å¤©æ•°æ®ï¼‰
- âœ… ç®€åŒ–äº†æœˆæŠ¥æ ‡é¢˜ï¼ŒåŽ»æŽ‰é‡å¤æ—¥æœŸ
- âœ… æ¶ˆé™¤äº†é‡å¤å‘é€çš„é—®é¢˜
- âœ… æ¯ä¸ªå“ç±»å‘é€ç»™å¯¹åº”çš„ç”¨æˆ·ç»„

### **å‘é€é€»è¾‘**
- ðŸ“¤ æ¯ä¸ªå“ç±»å•ç‹¬å‘é€
- ðŸ‘¥ æ¯ä¸ªå“ç±»å‘é€ç»™å¯¹åº”çš„ç”¨æˆ·ç»„
- ðŸ”„ é¿å…é‡å¤å‘é€
- ðŸ“Š è¯¦ç»†çš„å‘é€æ—¥å¿—è®°å½•

## ðŸš€ ä½¿ç”¨è¯´æ˜Ž

### **æ—¥æŠ¥è„šæœ¬**
```bash
python æ»žé”€åº“å­˜æ¸…ç†.py
```
- æ•°æ®èŒƒå›´: æ˜¨å¤©ä¸€å¤©
- å‘é€æ–¹å¼: æŒ‰å“ç±»åˆ†åˆ«å‘é€
- ç”¨æˆ·åŒ¹é…: æ ¹æ®å“ç±»å…³é”®è¯åŒ¹é…ç”¨æˆ·

### **æœˆæŠ¥è„šæœ¬**
```bash
python æ»žé”€åº“å­˜æ¸…ç†_æœˆæŠ¥.py
```
- æ•°æ®èŒƒå›´: å½“æœˆ1å·åˆ°T-1
- å‘é€æ–¹å¼: æŒ‰å“ç±»åˆ†åˆ«å‘é€
- ç”¨æˆ·åŒ¹é…: æ ¹æ®å“ç±»å…³é”®è¯åŒ¹é…ç”¨æˆ·

## ðŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®ç­›é€‰**: æ—¥æŠ¥åªå–æ˜¨å¤©æ•°æ®ï¼ŒæœˆæŠ¥å–å½“æœˆç´¯è®¡
2. **ç”¨æˆ·åŒ¹é…**: æ ¹æ®å“ç±»å…³é”®è¯è‡ªåŠ¨åŒ¹é…ç”¨æˆ·ç»„
3. **å‘é€æŽ§åˆ¶**: æ¯ä¸ªå“ç±»å•ç‹¬å‘é€ï¼Œé¿å…é‡å¤
4. **é”™è¯¯å¤„ç†**: å‘é€å¤±è´¥æ—¶ä¼šæŠ¥å‘Šç»™ç®¡ç†å‘˜ 