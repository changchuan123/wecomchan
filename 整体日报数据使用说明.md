# 整体日报数据.py - 一键运行说明

## 🎯 功能概述

`整体日报数据.py` 是一个**功能聚合脚本**，专为影刀RPA环境优化，一键完成以下所有任务：

✅ **数据分析** - 自动分析ERP订单明细和分销数据  
✅ **HTML报告生成** - 生成可视化销售报告  
✅ **EdgeOne云端部署** - 自动部署到腾讯云EdgeOne CDN  
✅ **企业微信推送** - 发送报告摘要和Web链接  

## 🚀 使用方法

### 在影刀RPA中运行

1. **直接执行**：在影刀中运行 `整体日报数据.py` 脚本
2. **自动检测**：脚本会自动检测影刀环境并使用优化配置
3. **一键完成**：无需额外操作，所有功能自动执行

### 执行流程

```
🤖 影刀环境检测 → 📊 数据分析 → 📄 HTML生成 → 🌐 EdgeOne部署 → 📱 微信推送
```

## 🔧 环境要求

### 必需组件
- ✅ Python 3.x
- ✅ EdgeOne CLI（腾讯云命令行工具）
- ✅ 网络连接

### 数据源
- ✅ ERP订单明细数据库
- ✅ 分销数据（HT_fenxiao表）

## 🤖 影刀环境优化特性

### 智能路径检测
- 自动检测影刀内置Node.js路径
- 支持多种EdgeOne CLI安装位置
- 智能回退到系统默认命令

### 环境适配
- UTF-8编码设置
- 影刀特定环境变量配置
- 优化的错误处理机制

### 故障排除
- 自动诊断常见问题
- 提供针对性解决建议
- 详细的错误日志记录

## 📋 输出结果

### 本地文件
- `reports/销售日报_YYYY-MM-DD.html` - 完整HTML报告
- `sales_analysis.log` - 执行日志

### 云端部署
- **Web报告URL**: `https://edge.haierht.cn/销售日报_YYYY-MM-DD.html`
- **CDN加速**: 全球访问优化
- **移动端适配**: 响应式设计

### 企业微信推送
- 📊 销售数据摘要
- 📈 环比增长分析
- 🔗 Web报告链接
- 🏪 重点店铺监控

## ⚠️ 故障排除

### EdgeOne CLI问题
```bash
# 在影刀中手动安装
npm install -g @tencent/edgeone-cli
```

### 网络连接问题
- 检查防火墙设置
- 确认代理配置
- 验证DNS解析

### 权限问题
- 确保文件写入权限
- 检查EdgeOne API Token
- 验证数据库连接权限

## 🔄 定时执行

### 影刀定时任务
1. 在影刀中创建定时任务
2. 设置执行脚本为 `整体日报数据.py`
3. 配置执行时间（建议每日上午9点）

### 执行频率建议
- **日报**: 每日上午9:00执行
- **周报**: 每周一上午9:00执行
- **月报**: 每月1日上午9:00执行

## 📞 技术支持

如遇问题，请检查：
1. 📋 执行日志 `sales_analysis.log`
2. 🌐 网络连接状态
3. 🔑 API Token有效性
4. 💾 数据库连接状态

---

**注意**: 此脚本已针对影刀RPA环境进行全面优化，无需额外配置即可直接使用。