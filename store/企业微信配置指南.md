# 企业微信配置指南

## 配置步骤

### 1. 获取企业ID (corpid)
1. 登录企业微信管理后台：https://work.weixin.qq.com/wework_admin/
2. 在左侧菜单找到"我的企业"
3. 点击"企业信息"
4. 在页面中找到"企业ID"，复制这个值

### 2. 创建应用并获取Secret和AgentId
1. 在企业微信管理后台，点击"应用管理"
2. 点击"自建应用" -> "创建应用"
3. 填写应用名称（如：库存推送）
4. 选择可见范围（建议选择全部成员）
5. 创建完成后，点击应用名称进入应用详情
6. 在"应用详情"页面找到：
   - **AgentId**：应用ID
   - **Secret**：点击"查看"按钮获取Secret

### 3. 配置脚本
在 `库存数据处理.py` 文件中找到以下配置部分：

```python
# 企业微信配置 - 请在此处填写您的配置信息
WECOM_CONFIG = {
    'corpid': '',  # 请填写您的企业ID
    'corpsecret': '',  # 请填写您的应用Secret
    'agentid': '',  # 请填写您的应用ID
    'touser': 'weicungang'  # 接收消息的用户ID
}
```

将获取到的值填入对应字段：
- `corpid`：填入企业ID
- `corpsecret`：填入应用Secret
- `agentid`：填入应用AgentId
- `touser`：填入接收消息的用户ID（可以是多个用户，用逗号分隔）

### 4. 测试配置
配置完成后，运行脚本：
```bash
python3 库存数据处理.py
```

如果配置正确，脚本会成功发送企业微信消息。

## 注意事项

1. **Secret安全**：Secret是敏感信息，请妥善保管，不要泄露给他人
2. **权限设置**：确保应用有发送消息的权限
3. **用户ID**：确保填写的用户ID在企业微信中存在
4. **网络连接**：确保服务器能够访问企业微信API

## 常见问题

### Q: 提示"corpsecret missing"错误
A: 请检查是否已正确填写corpsecret字段

### Q: 提示"agentid missing"错误
A: 请检查是否已正确填写agentid字段

### Q: 消息发送失败
A: 请检查：
1. 网络连接是否正常
2. 应用权限是否正确
3. 用户ID是否正确

## 配置示例

```python
WECOM_CONFIG = {
    'corpid': 'ww1234567890abcdef',  # 示例企业ID
    'corpsecret': 'abcdef1234567890abcdef1234567890',  # 示例Secret
    'agentid': '1000001',  # 示例AgentId
    'touser': 'weicungang'  # 接收消息的用户ID
}
``` 