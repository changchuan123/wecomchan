<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>2025å¹´6æœˆé”€å”®æœˆæŠ¥ - ä¼˜åŒ–ç‰ˆ</title>
    <style>
        body { font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif; background: #f8f9fa; color: #222; margin: 0; padding: 0.8em; max-width: 900px; margin-left:auto; margin-right:auto; text-align: left; font-size: 9pt; }
        h1, h2, h3 { color: #0056b3; text-align: left; font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif; font-weight: bold; }
        h1 { font-size: 13pt; margin-top: 0.5em; margin-bottom: 0.5em; }
        h2 { font-size: 12pt; margin-top: 0.5em; margin-bottom: 0.5em; }
        h3 { font-size: 11pt; margin-top: 0.5em; margin-bottom: 0.5em; }
        .section { margin-bottom: 1em; text-align: left; }
        .highlight { color: #d63384; font-weight: bold; }
        .emoji { font-size: 1.2em; }
        details { margin-bottom: 1em; }
        summary { cursor: pointer; font-weight: bold; }
        @media (max-width: 600px) { body { padding: 0.5em; font-size: 10.5pt; } h1 { font-size: 14pt; } }
        .left-align { text-align: left !important; }
        .overview-box { background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #2196f3; }
        .growth-positive { background: #e8f5e8; border-left: 3px solid #4caf50; }
        .growth-negative { background: #ffeaea; border-left: 3px solid #f44336; }
        .item-line { display: inline-block; width: 100%; margin-bottom: 5px; padding: 8px; border-radius: 4px; }
        .details-container { margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; }
        .details-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .details-table th, .details-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid #dee2e6; }
        .details-table th { background-color: #e9ecef; font-weight: bold; }
        .details-table tr:hover { background-color: #f5f5f5; }
        .loading { opacity: 0.6; pointer-events: none; }
        .loading-message { text-align: center; padding: 20px; color: #666; }
    </style>
</head>
<body>
    <h1>2025å¹´6æœˆé”€å”®æœˆæŠ¥ - ä¼˜åŒ–ç‰ˆ</h1>
    
    <!-- 30æ—¥è¶‹åŠ¿å›¾ -->
    <div class="section">
        <h2>ğŸ“ˆ è¿‘30å¤©é”€å”®è¶‹åŠ¿å›¾</h2>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px;">
            <label>å“ç±»ï¼š
                <select id="selCategory" onchange="updateFilters('category');debouncedUpdateChart()">
                    <option value="all">å…¨éƒ¨</option>
                </select>
            </label>
            <label>åº—é“ºï¼š
                <select id="selShop" onchange="updateFilters('shop');debouncedUpdateChart()">
                    <option value="all">å…¨éƒ¨</option>
                </select>
            </label>
            <label>å•å“ï¼š
                <select id="selProduct" onchange="debouncedUpdateChart()">
                    <option value="all">å…¨éƒ¨</option>
                </select>
            </label>
        </div>
        <div id="chartContainer">
            <canvas id="trendChart" width="800" height="280" style="max-width:100%;"></canvas>
        </div>
        
        <!-- é»˜è®¤æ•°æ®è¡¨æ ¼ -->
        <div id="defaultDataContainer" style="margin: 10px 0; padding: 10px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
            <h4>è¿‘30å¤©æ—¥é”€æ•°æ®</h4>
            <div style="overflow-x: auto;">
                <table id="defaultDataTable" class="details-table" style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr id="defaultTableHeader">
                            <th style="min-width: 80px; text-align: center; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;">æŒ‡æ ‡</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="salesAmountRow">
                            <td style="text-align: center; padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9; font-weight: bold;">é”€å”®é¢(ä¸‡)</td>
                        </tr>
                        <tr id="salesQtyRow">
                            <td style="text-align: center; padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9; font-weight: bold;">é”€é‡(ä»¶)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <script src="https://cdn.jsdelivr.net/npm/chart.js">
        <script>
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const icon = document.getElementById(sectionId + '-icon');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        </script>
        
</script>
        <script>
        // é«˜æ€§èƒ½æ•°æ®ç¼“å­˜ç³»ç»Ÿ
        class DataCache {
            constructor() {
                this.byDate = new Map();
                this.byShop = new Map();
                this.byCategory = new Map();
                this.byProduct = new Map();
                this.processed = false;
                this.sortedDates = [];
                this.allShops = new Set();
                this.allCategories = new Set();
                this.allProducts = new Set();
                this.aggregatedData = new Map();
            }
            
            // æ‰¹é‡å¤„ç†æ•°æ®ä»¥é¿å…UIé˜»å¡
            async preprocessData(trendData) {
                if (this.processed) return;
                
                const batchSize = 1000;
                const batches = [];
                
                // åˆ†æ‰¹å¤„ç†æ•°æ®
                for (let i = 0; i < trendData.length; i += batchSize) {
                    batches.push(trendData.slice(i, i + batchSize));
                }
                
                for (let batch of batches) {
                    await this.processBatch(batch);
                    // è®©å‡ºæ§åˆ¶æƒç»™UI
                    await new Promise(resolve => setTimeout(resolve, 0));
                }
                
                this.sortedDates = Array.from(this.byDate.keys()).sort();
                this.processed = true;
            }
            
            async processBatch(batch) {
                batch.forEach(item => {
                    const { date, shop, category, product, amount = 0, qty = 0 } = item;
                    
                    // ç´¢å¼•åŒ–æ•°æ®
                    if (!this.byDate.has(date)) this.byDate.set(date, []);
                    if (!this.byShop.has(shop)) this.byShop.set(shop, []);
                    if (!this.byCategory.has(category)) this.byCategory.set(category, []);
                    if (!this.byProduct.has(product)) this.byProduct.set(product, []);
                    
                    this.byDate.get(date).push(item);
                    this.byShop.get(shop).push(item);
                    this.byCategory.get(category).push(item);
                    this.byProduct.get(product).push(item);
                    
                    this.allShops.add(shop);
                    this.allCategories.add(category);
                    this.allProducts.add(product);
                });
            }
            
            // å¿«é€Ÿè¿‡æ»¤æ•°æ®
            getFilteredData(selectedShop, selectedCategory, selectedProduct) {
                const cacheKey = `${selectedShop}-${selectedCategory}-${selectedProduct}`;
                
                if (this.aggregatedData.has(cacheKey)) {
                    return this.aggregatedData.get(cacheKey);
                }
                
                let filteredItems = [];
                
                // ä½¿ç”¨ç´¢å¼•å¿«é€Ÿè¿‡æ»¤
                if (selectedShop !== 'all' && selectedCategory !== 'all' && selectedProduct !== 'all') {
                    // ä¸‰é‡è¿‡æ»¤ï¼šæ‰¾äº¤é›†
                    const shopItems = this.byShop.get(selectedShop) || [];
                    filteredItems = shopItems.filter(item => 
                        item.category === selectedCategory && item.product === selectedProduct
                    );
                } else if (selectedShop !== 'all' && selectedCategory !== 'all') {
                    // åŒé‡è¿‡æ»¤
                    const shopItems = this.byShop.get(selectedShop) || [];
                    filteredItems = shopItems.filter(item => item.category === selectedCategory);
                } else if (selectedShop !== 'all') {
                    filteredItems = this.byShop.get(selectedShop) || [];
                } else if (selectedCategory !== 'all') {
                    filteredItems = this.byCategory.get(selectedCategory) || [];
                } else if (selectedProduct !== 'all') {
                    filteredItems = this.byProduct.get(selectedProduct) || [];
                } else {
                    // å…¨éƒ¨æ•°æ®
                    filteredItems = Array.from(this.byDate.values()).flat();
                }
                
                // ç¼“å­˜ç»“æœ
                this.aggregatedData.set(cacheKey, filteredItems);
                return filteredItems;
            }
        }
        
        // å…¨å±€å˜é‡
        let chart;
        let dataCache = new DataCache();
        
        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // åˆ›å»ºé˜²æŠ–çš„å›¾è¡¨æ›´æ–°å‡½æ•°
        const debouncedUpdateChart = debounce(updateChart, 50);
        
        function initChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 300 // å‡å°‘åŠ¨ç”»æ—¶é—´
                    },
                    interaction: {
                        mode: 'point',
                        intersect: true
                    },
                    onClick: function(event, elements) {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const index = element.index;
                            const date = chart.data.labels[index];
                            showDateDetails(date);
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'é”€å”®è¶‹åŠ¿'
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'point',
                            intersect: true,
                            callbacks: {
                                label: function(context) {
                                    if (context.dataset.type === 'line') {
                                        return context.dataset.label + ': ' + context.parsed.y + 'ä»¶';
                                    } else {
                                        return context.dataset.label + ': Â¥' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é”€å”®é¢ (Â¥)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é”€é‡ (ä»¶)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
        }
        
        function initFilters() {
            if (!dataCache.processed) return;
            
            // å¡«å……å“ç±»é€‰é¡¹ï¼ˆæŒ‰é”€å”®é¢æ’åºï¼‰
            populateCategoryOptions();
            
            // å¡«å……åº—é“ºé€‰é¡¹ï¼ˆæŒ‰é”€å”®é¢æ’åºï¼‰
            populateShopOptions();
            
            // å¡«å……å•å“é€‰é¡¹ï¼ˆæŒ‰é”€é‡æ’åºï¼‰
            populateProductOptions();
        }
        
        function populateCategoryOptions(selectedShop = 'all') {
            const categorySelect = document.getElementById('selCategory');
            const currentValue = categorySelect.value;
            
            // è®¡ç®—å“ç±»é”€å”®é¢
            const categoryStats = {};
            
            if (selectedShop === 'all') {
                dataCache.allCategories.forEach(category => {
                    const items = dataCache.byCategory.get(category) || [];
                    categoryStats[category] = items.reduce((sum, item) => sum + (item.amount || 0), 0);
                });
            } else {
                const shopItems = dataCache.byShop.get(selectedShop) || [];
                shopItems.forEach(item => {
                    if (!categoryStats[item.category]) {
                        categoryStats[item.category] = 0;
                    }
                    categoryStats[item.category] += item.amount || 0;
                });
            }
            
            // æŒ‰é”€å”®é¢æ’åº
            const sortedCategories = Object.keys(categoryStats).sort((a, b) => categoryStats[b] - categoryStats[a]);
            
            // é‡æ–°å¡«å……é€‰é¡¹
            categorySelect.innerHTML = '<option value="all">å…¨éƒ¨</option>';
            sortedCategories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });
            
            // æ¢å¤ä¹‹å‰çš„é€‰æ‹©
            if (currentValue && sortedCategories.includes(currentValue)) {
                categorySelect.value = currentValue;
            }
        }
        
        function populateShopOptions(selectedCategory = 'all') {
            const shopSelect = document.getElementById('selShop');
            const currentValue = shopSelect.value;
            
            // è®¡ç®—åº—é“ºé”€å”®é¢
            const shopStats = {};
            
            if (selectedCategory === 'all') {
                dataCache.allShops.forEach(shop => {
                    const items = dataCache.byShop.get(shop) || [];
                    shopStats[shop] = items.reduce((sum, item) => sum + (item.amount || 0), 0);
                });
            } else {
                const categoryItems = dataCache.byCategory.get(selectedCategory) || [];
                categoryItems.forEach(item => {
                    if (!shopStats[item.shop]) {
                        shopStats[item.shop] = 0;
                    }
                    shopStats[item.shop] += item.amount || 0;
                });
            }
            
            // æŒ‰é”€å”®é¢æ’åº
            const sortedShops = Object.keys(shopStats).sort((a, b) => shopStats[b] - shopStats[a]);
            
            // é‡æ–°å¡«å……é€‰é¡¹
            shopSelect.innerHTML = '<option value="all">å…¨éƒ¨</option>';
            sortedShops.forEach(shop => {
                const option = document.createElement('option');
                option.value = shop;
                option.textContent = shop;
                shopSelect.appendChild(option);
            });
            
            // æ¢å¤ä¹‹å‰çš„é€‰æ‹©
            if (currentValue && sortedShops.includes(currentValue)) {
                shopSelect.value = currentValue;
            }
        }
        
        function populateProductOptions(selectedCategory = 'all', selectedShop = 'all') {
            const productSelect = document.getElementById('selProduct');
            const currentValue = productSelect.value;
            
            // è®¡ç®—å•å“é”€é‡
            const productStats = {};
            
            let items = [];
            if (selectedCategory !== 'all' && selectedShop !== 'all') {
                const shopItems = dataCache.byShop.get(selectedShop) || [];
                items = shopItems.filter(item => item.category === selectedCategory);
            } else if (selectedCategory !== 'all') {
                items = dataCache.byCategory.get(selectedCategory) || [];
            } else if (selectedShop !== 'all') {
                items = dataCache.byShop.get(selectedShop) || [];
            } else {
                items = Array.from(dataCache.byProduct.keys()).map(product => 
                    dataCache.byProduct.get(product) || []
                ).flat();
            }
            
            items.forEach(item => {
                const product = item.product || '';
                // è¿‡æ»¤æ‰å«æœ‰è¿è´¹ã€å®¤å¤–æœºã€èµ å“ã€è™šæ‹Ÿå­—æ ·çš„å•å“
                if (product.includes('è¿è´¹') || product.includes('å®¤å¤–æœº') || 
                    product.includes('èµ å“') || product.includes('è™šæ‹Ÿ')) {
                    return;
                }
                
                if (!productStats[item.product]) {
                    productStats[item.product] = 0;
                }
                productStats[item.product] += item.qty || 0;
            });
            
            // æŒ‰é”€é‡æ’åº
            const sortedProducts = Object.keys(productStats).sort((a, b) => productStats[b] - productStats[a]);
            
            // é‡æ–°å¡«å……é€‰é¡¹
            productSelect.innerHTML = '<option value="all">å…¨éƒ¨</option>';
            sortedProducts.forEach(product => {
                const option = document.createElement('option');
                option.value = product;
                option.textContent = product;
                productSelect.appendChild(option);
            });
            
            // æ¢å¤ä¹‹å‰çš„é€‰æ‹©
            if (currentValue && sortedProducts.includes(currentValue)) {
                productSelect.value = currentValue;
            }
        }
        
        function updateFilters(changedFilter) {
            const selectedCategory = document.getElementById('selCategory').value;
            const selectedShop = document.getElementById('selShop').value;
            
            if (changedFilter === 'category') {
                populateShopOptions(selectedCategory);
                populateProductOptions(selectedCategory, selectedShop);
            } else if (changedFilter === 'shop') {
                populateCategoryOptions(selectedShop);
                populateProductOptions(selectedCategory, selectedShop);
            }
        }
        
        async function updateChart() {
            if (!dataCache.processed) return;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const chartContainer = document.getElementById('chartContainer');
            chartContainer.style.opacity = '0.6';
            
            // ä½¿ç”¨setTimeoutè®©UIæœ‰æœºä¼šæ›´æ–°
            setTimeout(async () => {
                try {
                    const selectedShop = document.getElementById('selShop').value;
                    const selectedCategory = document.getElementById('selCategory').value;
                    const selectedProduct = document.getElementById('selProduct').value;
                    
                    // ç¡®å®šå †ç§¯ç»´åº¦
                    let stackDimension;
                    if (selectedCategory === 'all' && selectedShop === 'all' && selectedProduct === 'all') {
                        stackDimension = 'category';
                    } else if (selectedCategory !== 'all' && selectedShop === 'all') {
                        stackDimension = 'shop';
                    } else if (selectedShop !== 'all' && selectedCategory === 'all') {
                        stackDimension = 'product';
                    } else if (selectedCategory === 'all' && selectedShop === 'all' && selectedProduct !== 'all') {
                        stackDimension = 'shop';
                    } else {
                        stackDimension = 'product';
                    }
                    
                    // ä½¿ç”¨ç¼“å­˜å¿«é€Ÿè·å–è¿‡æ»¤æ•°æ®
                    const filteredData = dataCache.getFilteredData(selectedShop, selectedCategory, selectedProduct);
                    
                    // æŒ‰æ—¥æœŸå’Œå †ç§¯ç»´åº¦èšåˆæ•°æ®
                    const aggregatedData = {};
                    const stackItems = new Set();
                    
                    filteredData.forEach(item => {
                        const date = item.date;
                        const stackKey = item[stackDimension];
                        
                        if (!aggregatedData[date]) {
                            aggregatedData[date] = {};
                        }
                        if (!aggregatedData[date][stackKey]) {
                            aggregatedData[date][stackKey] = { amount: 0, qty: 0 };
                        }
                        
                        aggregatedData[date][stackKey].amount += item.amount || 0;
                        aggregatedData[date][stackKey].qty += item.qty || 0;
                        stackItems.add(stackKey);
                    });
                    
                    // æ’åºæ—¥æœŸå’Œå †ç§¯é¡¹
                    const sortedDates = Object.keys(aggregatedData).sort();
                    const sortedStackItems = Array.from(stackItems).sort();
                    
                    // ç”Ÿæˆé¢œè‰²
                    const colors = [
                        '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                        '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384',
                        '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'
                    ];
                    
                    // æ„å»ºæ•°æ®é›†
                    const datasets = [];
                    
                    // è®¡ç®—å„åˆ†æ®µè¿‘30å¤©ç´¯è®¡é‡‘é¢ç”¨äºæ’åº
                    const stackItemTotals = {};
                    sortedStackItems.forEach(stackItem => {
                        let total = 0;
                        sortedDates.forEach(date => {
                            total += aggregatedData[date][stackItem] ? aggregatedData[date][stackItem].amount : 0;
                        });
                        stackItemTotals[stackItem] = total;
                    });
                    
                    // æŒ‰è¿‘30å¤©ç´¯è®¡é‡‘é¢ä»å¤§åˆ°å°æ’åº
                    const sortedByAmount = sortedStackItems.sort((a, b) => stackItemTotals[b] - stackItemTotals[a]);
                    
                    // å †ç§¯æŸ±çŠ¶å›¾æ•°æ®é›†ï¼ˆé”€å”®é¢ï¼‰
                    sortedByAmount.forEach((stackItem, index) => {
                        const data = sortedDates.map(date => {
                            return aggregatedData[date][stackItem] ? aggregatedData[date][stackItem].amount : 0;
                        });
                        
                        datasets.push({
                            label: stackItem,
                            data: data,
                            backgroundColor: colors[index % colors.length],
                            borderColor: colors[index % colors.length],
                            borderWidth: 1,
                            type: 'bar',
                            stack: 'amount'
                        });
                    });
                    
                    // æŠ˜çº¿å›¾æ•°æ®é›†ï¼ˆé”€é‡ï¼‰
                    const qtyData = sortedDates.map(date => {
                        let totalQty = 0;
                        Object.values(aggregatedData[date] || {}).forEach(item => {
                            totalQty += item.qty;
                        });
                        return totalQty;
                    });
                    
                    datasets.push({
                        label: 'é”€é‡',
                        data: qtyData,
                        borderColor: '#FF6384',
                        backgroundColor: 'rgba(255, 99, 132, 0.1)',
                        borderWidth: 2,
                        type: 'line',
                        yAxisID: 'y1',
                        tension: 0.1,
                        fill: false
                    });
                    
                    // æ›´æ–°å›¾è¡¨
                    chart.data.labels = sortedDates.map(date => {
                        const d = new Date(date);
                        return (d.getMonth() + 1) + '-' + d.getDate().toString().padStart(2, '0');
                    });
                    chart.data.datasets = datasets;
                    chart.update('none'); // ç¦ç”¨åŠ¨ç”»ä»¥æé«˜æ€§èƒ½
                    
                    // æ›´æ–°é»˜è®¤æ•°æ®è¡¨æ ¼
                    updateDefaultDataTable();
                    
                } catch (error) {
                    console.error('å›¾è¡¨æ›´æ–°é”™è¯¯:', error);
                } finally {
                    // æ¢å¤å›¾è¡¨å®¹å™¨é€æ˜åº¦
                    setTimeout(() => {
                        chartContainer.style.opacity = '1';
                    }, 100);
                }
            }, 10);
        }
        
        function updateDefaultDataTable() {
            if (!dataCache.processed) return;
            
            const selectedShop = document.getElementById('selShop').value;
            const selectedCategory = document.getElementById('selCategory').value;
            const selectedProduct = document.getElementById('selProduct').value;
            
            // ä½¿ç”¨ç¼“å­˜å¿«é€Ÿè·å–è¿‡æ»¤æ•°æ®
            const filteredData = dataCache.getFilteredData(selectedShop, selectedCategory, selectedProduct);
            
            // æŒ‰æ—¥æœŸèšåˆæ•°æ®
            const aggregatedData = {};
            filteredData.forEach(item => {
                const date = item.date;
                if (!aggregatedData[date]) {
                    aggregatedData[date] = { amount: 0, qty: 0 };
                }
                aggregatedData[date].amount += item.amount || 0;
                aggregatedData[date].qty += item.qty || 0;
            });
            
            // æ’åºæ—¥æœŸ
            const sortedDates = Object.keys(aggregatedData).sort();
            
            // æ¸…ç©ºç°æœ‰çš„æ—¥æœŸåˆ—
            const headerRow = document.getElementById('defaultTableHeader');
            const salesAmountRow = document.getElementById('salesAmountRow');
            const salesQtyRow = document.getElementById('salesQtyRow');
            
            // ä¿ç•™ç¬¬ä¸€åˆ—ï¼Œæ¸…ç©ºå…¶ä»–åˆ—
            while (headerRow.children.length > 1) {
                headerRow.removeChild(headerRow.lastChild);
            }
            while (salesAmountRow.children.length > 1) {
                salesAmountRow.removeChild(salesAmountRow.lastChild);
            }
            while (salesQtyRow.children.length > 1) {
                salesQtyRow.removeChild(salesQtyRow.lastChild);
            }
            
            // æ·»åŠ æ—¥æœŸåˆ—å’Œæ•°æ®
            sortedDates.forEach(date => {
                const data = aggregatedData[date];
                
                // æ ¼å¼åŒ–æ—¥æœŸ
                const d = new Date(date);
                const formattedDate = (d.getMonth() + 1) + '-' + d.getDate().toString().padStart(2, '0');
                
                // æ·»åŠ æ—¥æœŸè¡¨å¤´
                const headerCell = document.createElement('th');
                headerCell.style.cssText = 'min-width: 80px; text-align: center; padding: 8px; border: 1px solid #ddd; background-color: #f5f5f5;';
                headerCell.textContent = formattedDate;
                headerRow.appendChild(headerCell);
                
                // æ·»åŠ é”€å”®é¢æ•°æ®ï¼ˆä¸‡å…ƒï¼‰
                const amountCell = document.createElement('td');
                amountCell.style.cssText = 'text-align: center; padding: 8px; border: 1px solid #ddd;';
                const amountInWan = Math.round(data.amount / 10000);
                amountCell.textContent = amountInWan.toLocaleString();
                salesAmountRow.appendChild(amountCell);
                
                // æ·»åŠ é”€é‡æ•°æ®
                const qtyCell = document.createElement('td');
                qtyCell.style.cssText = 'text-align: center; padding: 8px; border: 1px solid #ddd;';
                qtyCell.textContent = data.qty.toLocaleString();
                salesQtyRow.appendChild(qtyCell);
            });
        }
        
        function showDateDetails(date) {
            // ç®€åŒ–ç‰ˆæœ¬ï¼Œæš‚æ—¶ä¸å®ç°è¯¦ç»†åŠŸèƒ½
            console.log('æ˜¾ç¤ºæ—¥æœŸè¯¦æƒ…:', date);
        }
        
        // çœŸå®çš„trendDataæ•°æ®
        const trendData = [{"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸åŸçŸ³å†°ç®±æ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-600WGCFDM4DBU1", "amount": 13600.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸åŸçŸ³å†°ç®±æ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-610WLCTDAGSCU1(Pro)", "amount": 13150.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸å¤§æ„‰ä¸“å–åº—", "category": "æ´—è¡£æœº", "product": "CE B12LWDUKLBU1", "amount": 5999.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸æ´—çƒ˜å¥—è£…æ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "C1 D10LJ7ELU1", "amount": 4000.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸æ´—çƒ˜å¥—è£…æ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "CGS 10FLJ7EU1", "amount": 4000.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KFRD70-32W-SEå¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KSXD-200(70)/WS-Eå†…æœº", "amount": 3143.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "EC1122-FCW", "amount": 6630.0, "qty": 13}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "EC6.6FBP3", "amount": 578.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "ES15U", "amount": 599.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-100L/DF82U1å®¤å†…æœº", "amount": 7298.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-100W/582å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/E1-1Pluså®¤å†…æœº", "amount": 7146.969999999999, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/E1-1å®¤å†…æœº", "amount": 9394.95, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/KJA81U1å®¤å†…æœº", "amount": 9244.95, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LAA81U1å®¤å†…æœºæ€»æˆ", "amount": 1998.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LPA1-1å®¤å†…æœº", "amount": 67854.55, "qty": 45}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/MTB81TU1(é«˜å…‰ç™½)å®¤å†…æœº", "amount": 1598.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/0281Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/30-1Lå®¤å¤–æœº", "amount": 0.45, "qty": 45}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/A3-1å®¤å¤–æœº", "amount": 0.03, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/B181å®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/B581å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/C2-1å®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48G/MDA81TU1å®¤å†…æœº", "amount": 23505.68, "qty": 10}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48W/1881Tå®¤å¤–æœº", "amount": 0.1, "qty": 10}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72G/KEA81U1å®¤å†…æœºæ€»æˆ", "amount": 5698.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72G/PAA81U1å®¤å†…æœº", "amount": 4298.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/KCA81U1(å†°é›ªç™½)å®¤å†…æœº", "amount": 9203.24, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/LKB81TU1å®¤å†…æœº", "amount": 30021.32, "qty": 8}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/LPA1-1å®¤å†…æœº", "amount": 3998.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/0381Tå®¤å¤–æœº", "amount": 0.08, "qty": 8}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/2281å®¤å¤–æœºæ€»æˆ", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/2481å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/2881å®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å‡€çœç”µç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/50-1Lå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å¤§æ„‰æ™¾è¡£æ¶æ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "EG100BD176PRO", "amount": 4456.0, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "å†°ç®±", "product": "BC-93LTMPA", "amount": 3016.0, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-123GHTMZ0WV", "amount": 828.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-88GHTMZ0WV", "amount": 4376.0, "qty": 6}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "æ´—ç¢—æœº", "product": "EBW12227BKU1", "amount": 7597.0, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "æ´—ç¢—æœº", "product": "EYBW152266BKU1", "amount": 2798.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "æ´—ç¢—æœº", "product": "EYBW16328GHU1", "amount": 2959.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”æ´—åµŒæ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "EG100BD39S", "amount": 1399.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—", "category": "å†°ç®±", "product": "BCD-88GHTMZ0WV", "amount": 749.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120L/TF82Tå®¤å†…æœº", "amount": 6833.98, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120W/5Y82Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/KJA81U1å®¤å†…æœº", "amount": 5546.97, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/B181å®¤å¤–æœº", "amount": 0.03, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å…¶ä»–", "product": "åˆ¶å†·è¿è´¹", "amount": 98.6, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å†°ç®±", "product": "BC-93LTMPA", "amount": 18569.0, "qty": 31}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å†°ç®±", "product": "BCD-123GHTMZ0WV", "amount": 829.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å†°ç®±", "product": "BCD-510WGHFD1BNXU1", "amount": 11998.0, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å†°ç®±", "product": "BCD-88GHTMZ0WV", "amount": 12393.0, "qty": 17}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120L/AF81å®¤å†…æœº", "amount": 19197.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120L/TF82Tå®¤å†…æœº", "amount": 6998.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120W/5Y82Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120W/7Y81å®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-72N/ECA81U1å®¤å†…æœº", "amount": 7298.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-72W/7281å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-75Q/TB82Tå®¤å†…æœº", "amount": 5398.98, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-75W/482Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å•†ç”¨ç©ºè°ƒ", "product": "TPB-05Q/YH", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26G/E1-1å®¤å†…æœº", "amount": 1898.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26W/C2-1å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/E1-1Pluså®¤å†…æœº", "amount": 12494.949999999999, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/E1-1å®¤å†…æœº", "amount": 3997.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/KJA81U1å®¤å†…æœº", "amount": 85956.57, "qty": 43}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LAA81U1å®¤å†…æœºæ€»æˆ", "amount": 3997.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LKG81TU1å®¤å†…æœº", "amount": 13591.92, "qty": 8}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LPA1-1å®¤å†…æœº", "amount": 40775.76, "qty": 24}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/0581Tå®¤å¤–æœº", "amount": 0.08, "qty": 8}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/30-1Lå®¤å¤–æœº", "amount": 0.24, "qty": 24}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/A3-1å®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/B181å®¤å¤–æœº", "amount": 0.43, "qty": 43}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/B581å®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/C2-1å®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48G/MDA81TU1å®¤å†…æœº", "amount": 12244.949999999999, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48W/1881Tå®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72G/PAA81U1å®¤å†…æœº", "amount": 19595.96, "qty": 4}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/E1-1å®¤å†…æœº", "amount": 5298.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/LKB81TU1å®¤å†…æœº", "amount": 3998.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/LPA1-1å®¤å†…æœº", "amount": 19994.949999999997, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/0381Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/2481å®¤å¤–æœº", "amount": 0.04, "qty": 4}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/50-1Lå®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/B6-1å®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "æ´—ç¢—æœº", "product": "EBW12227BKU1", "amount": 5498.0, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "æ´—è¡£æœº", "product": "EG100BD176PRO", "amount": 3598.0, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”ç©ºè°ƒåº—å¤§æ„‰ä¾›é”€", "category": "ç”µçƒ­æ°´å™¨", "product": "EC8002-MA3U1", "amount": 1100.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å…¶ä»–", "product": "ç©ºè°ƒè¿è´¹", "amount": 50.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26G/LA1-1å®¤å†…æœº", "amount": 1598.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26W/30-1Lå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LKG81TU1å®¤å†…æœº", "amount": 3197.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LPA1-1å®¤å†…æœº", "amount": 3097.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/MTB81TU1(é«˜å…‰ç™½)å®¤å†…æœº", "amount": 1598.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/0281Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/0581Tå®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/30-1Lå®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48G/MDA81TU1å®¤å†…æœº", "amount": 4698.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48W/1881Tå®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72G/MDA83TU1å®¤å†…æœºæ€»æˆ", "amount": 10346.97, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-ç»Ÿå¸…ç©ºè°ƒæ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/1883Tå®¤å¤–æœºæ€»æˆ", "amount": 0.03, "qty": 3}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å†°ç®±", "product": "BC-93LTMPA", "amount": 9106.0, "qty": 15}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å†°ç®±", "product": "BCD-123GHTMZ0WV", "amount": 1656.0, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å†°ç®±", "product": "BCD-88GHTMZ0WV", "amount": 749.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120L/TF82Tå®¤å†…æœº", "amount": 6833.98, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-120W/5Y82Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-75Q/TB82Tå®¤å†…æœº", "amount": 5368.98, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "KFRd-75W/482Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å•†ç”¨ç©ºè°ƒ", "product": "TPB-05Q/YH", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26G/LA1-1å®¤å†…æœº", "amount": 1598.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-26W/30-1Lå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LKG81TU1å®¤å†…æœº", "amount": 3187.98, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LPA1-1å®¤å†…æœº", "amount": 7484.95, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/0581Tå®¤å¤–æœº", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/30-1Lå®¤å¤–æœº", "amount": 0.05, "qty": 5}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72L/LKB81TU1å®¤å†…æœº", "amount": 3898.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-è™¹å›¾å…¨å“ç±»åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-72W/0381Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KF75/200-NE7(å¤–æœº)", "amount": 0.02, "qty": 2}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KF75/200-NE7-U1(å†…æœº)", "amount": 7997.98, "qty": 2}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35G/LPA1-1å®¤å†…æœº", "amount": 6389.96, "qty": 4}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-35W/30-1Lå®¤å¤–æœº", "amount": 0.04, "qty": 4}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48G/MDA81TU1å®¤å†…æœº", "amount": 2398.99, "qty": 1}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å®¶ç”¨ç©ºè°ƒ", "product": "KFR-48W/1881Tå®¤å¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "å¤©çŒ«-å–µé€Ÿè¾¾ç”µå™¨æ——èˆ°åº—", "category": "å®¶{"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸åŸçŸ³å†°ç®±æ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-600WGCFDM4DBU1", "amount": 13600.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸åŸçŸ³å†°ç®±æ——èˆ°åº—", "category": "å†°ç®±", "product": "BCD-610WLCTDAGSCU1(Pro)", "amount": 13150.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸å¤§æ„‰ä¸“å–åº—", "category": "æ´—è¡£æœº", "product": "CE B12LWDUKLBU1", "amount": 5999.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸æ´—çƒ˜å¥—è£…æ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "C1 D10LJ7ELU1", "amount": 4000.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-å¡è¨å¸æ´—çƒ˜å¥—è£…æ——èˆ°åº—", "category": "æ´—è¡£æœº", "product": "CGS 10FLJ7EU1", "amount": 4000.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KFRD70-32W-SEå¤–æœº", "amount": 0.01, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "å¤šèƒ½æºçƒ­æ°´å™¨", "product": "KSXD-200(70)/WS-Eå†…æœº", "amount": 3143.99, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "EC1122-FCW", "amount": 6630.0, "qty": 13}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "EC6.6FBP3", "amount": 578.0, "qty": 1}, {"date": "2025-06-24", "shop": "äº¬ä¸œ-æµ·å°”å…¨å±‹ç”¨æ°´æ——èˆ°åº—", "category": "ç”µçƒ­æ°´å™¨", "product": "ES15U", "amount": 599.0, "qty": 1}];
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            // æ˜¾ç¤ºåŠ è½½æ¶ˆæ¯
            const chartContainer = document.getElementById('chartContainer');
            chartContainer.innerHTML = '<div class="loading-message">æ­£åœ¨åŠ è½½æ•°æ®ï¼Œè¯·ç¨å€™...</div>';
            
            try {
                // é¢„å¤„ç†æ•°æ®
                await dataCache.preprocessData(trendData);
                
                // æ¢å¤å›¾è¡¨å®¹å™¨
                chartContainer.innerHTML = '<canvas id="trendChart" width="800" height="280" style="max-width:100%;"></canvas>';
                
                // åˆå§‹åŒ–å›¾è¡¨
                initChart();
                
                // åˆå§‹åŒ–ç­›é€‰é€‰é¡¹
                initFilters();
                
                // æ›´æ–°å›¾è¡¨
                await updateChart();
                
                console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œæ•°æ®å·²ä¼˜åŒ–å¤„ç†');
            } catch (error) {
                console.error('åˆå§‹åŒ–é”™è¯¯:', error);
                chartContainer.innerHTML = '<div class="loading-message">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
            }
        });
        
        <script>
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId + '-content');
            const icon = document.getElementById(sectionId + '-icon');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = 'â–²';
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼';
            }
        }
        </script>
        
</script>
    </div>
    
    <div class="overview-box">
        <h3>ğŸ“Š é”€å”®æ¦‚è§ˆ</h3>
        <p><strong>æœ¬æœˆé”€å”®é¢:</strong> Â¥33,116,518</p>
        <p><strong>æœ¬æœˆé”€é‡:</strong> 26,161ä»¶</p>
        <p><strong>å¹³å‡å•ä»·:</strong> Â¥1266</p>
        <p><strong>ç¯æ¯”å¢é•¿:</strong> ğŸ“ˆ 38.5%</p>
    </div>
    
    <div class="section">
        <h2>ğŸš€ æ€§èƒ½ä¼˜åŒ–è¯´æ˜</h2>
        <div class="overview-box">
            <h4>ä¼˜åŒ–ç‰¹æ€§:</h4>
            <ul>
                <li>âœ… æ•°æ®é¢„å¤„ç†å’Œç´¢å¼•åŒ– - é¿å…é‡å¤éå†</li>
                <li>âœ… æ‰¹é‡å¤„ç† - é˜²æ­¢UIé˜»å¡</li>
                <li>âœ… æ™ºèƒ½ç¼“å­˜ - å¿«é€Ÿè¿‡æ»¤æ•°æ®</li>
                <li>âœ… é˜²æŠ–æœºåˆ¶ - å‡å°‘ä¸å¿…è¦çš„æ›´æ–°</li>
                <li>âœ… å¼‚æ­¥åŠ è½½ - æå‡ç”¨æˆ·ä½“éªŒ</li>
                <li>âœ… åŠ¨ç”»ä¼˜åŒ– - å‡å°‘æ¸²æŸ“æ—¶é—´</li>
            </ul>
            <p><strong>ç›®æ ‡:</strong> 3ç§’å†…å®Œå…¨åŠ è½½ï¼Œæµç•…äº¤äº’ä½“éªŒ</p>
        </div>
    </div>
    
</body>
</html>