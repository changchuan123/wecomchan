# EdgeOne Pages 部署策略指南

## 🎯 问题背景

你直接上传了项目到EdgeOne Pages，但担心后续Git推送会覆盖直接上传的内容。

## 📋 解决方案

### 方案1：使用智能部署脚本（推荐）

```bash
# 运行智能部署脚本
python3 deploy_with_preserve.py
```

**功能特点：**
- ✅ 自动检测直接上传的内容
- ✅ 备份现有内容
- ✅ Git推送后恢复备份
- ✅ 确保内容不被覆盖

### 方案2：手动部署流程

#### 步骤1：备份当前内容
```bash
# 创建备份目录
mkdir -p backup/$(date +%Y%m%d_%H%M%S)
cp -r reports/* backup/$(date +%Y%m%d_%H%M%S)/
```

#### 步骤2：Git推送
```bash
git add .
git commit -m "部署更新"
git push
```

#### 步骤3：恢复备份
```bash
# 等待EdgeOne部署完成后，重新上传备份内容
# 或者使用EdgeOne控制台手动上传
```

### 方案3：配置EdgeOne保留策略

在EdgeOne控制台中：
1. 进入项目设置
2. 找到"部署策略"
3. 选择"合并模式"或"保留现有内容"

## 🔧 配置说明

### edgeone.json 配置
```json
{
  "deployment": {
    "strategy": "merge",
    "preserveUploads": true,
    "conflictResolution": "keep-both"
  }
}
```

### 部署配置文件
```json
{
  "preserve_uploads": true,
  "merge_strategy": "keep_both",
  "backup_before_deploy": true,
  "restore_after_deploy": true
}
```

## 📊 当前项目状态

- **项目名称**: sales-report-new
- **部署方式**: 直接上传
- **状态**: 运行中
- **域名**: sales-report-new.pages.edgeone.com

## 🚀 推荐工作流程

### 日常更新流程
1. **开发阶段**: 在本地修改代码
2. **测试阶段**: 使用本地服务器测试
3. **部署阶段**: 运行智能部署脚本
4. **验证阶段**: 检查EdgeOne控制台状态

### 紧急修复流程
1. **直接上传**: 在EdgeOne控制台直接上传修复文件
2. **记录变更**: 记录修改的文件和原因
3. **同步代码**: 将修改同步到Git仓库
4. **验证部署**: 确认修复生效

## ⚠️ 注意事项

### 避免的问题
- ❌ 不要直接Git推送而不备份
- ❌ 不要同时使用多种部署方式
- ❌ 不要忽略部署状态检查

### 最佳实践
- ✅ 使用智能部署脚本
- ✅ 定期备份重要内容
- ✅ 监控部署状态
- ✅ 保持Git仓库同步

## 🔍 故障排除

### 常见问题

#### 1. 部署后内容丢失
**解决方案**:
```bash
# 检查备份
ls -la backup/
# 恢复备份
python3 deploy_with_preserve.py
```

#### 2. Git推送失败
**解决方案**:
```bash
# 检查Git状态
git status
# 解决冲突
git pull origin master
# 重新推送
git push
```

#### 3. 域名访问失败
**解决方案**:
- 检查EdgeOne控制台项目状态
- 等待DNS解析生效（通常几分钟）
- 使用本地服务器测试

### 联系支持
- EdgeOne技术支持: 400-9100-100
- 项目文档: 查看GitHub仓库README

## 📈 监控和维护

### 定期检查
- [ ] 每周检查部署状态
- [ ] 每月备份重要数据
- [ ] 每季度更新部署策略

### 性能优化
- [ ] 监控页面加载速度
- [ ] 优化静态资源缓存
- [ ] 检查CDN节点分布

---
**更新时间**: 2025-08-06
**状态**: ✅ 就绪 