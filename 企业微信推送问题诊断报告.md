# 企业微信推送问题诊断报告

## 📋 问题概述

**问题现象**：执行完报告后，企业微信没有收到推送消息

**错误信息**：`{'errcode': 40013, 'errmsg': 'invalid corpid'}`

## 🔍 问题诊断

### 1. 服务器状态检查
- ✅ 服务器连接正常：`http://212.64.57.87:5001`
- ❌ 企业微信CID配置：未配置
- ❌ 企业微信AID配置：未配置
- ✅ sendkey配置：已配置

### 2. 错误分析
- **错误类型**：`invalid corpid` (企业微信公司ID无效)
- **错误代码**：40013
- **影响范围**：所有企业微信推送功能

## 🛠️ 根本原因

服务器端 `212.64.57.87:5001` 的企业微信配置有问题：

1. **企业微信公司ID (corpid) 无效或已过期**
2. **企业微信应用Secret可能已失效**
3. **企业微信应用权限设置可能有问题**

## 💡 解决方案

### 方案一：联系服务器管理员（推荐）
1. 联系服务器管理员 (212.64.57.87)
2. 更新服务器端的企业微信应用配置
3. 确认企业微信应用的公司ID、Secret和应用ID
4. 检查企业微信应用的权限设置

### 方案二：临时禁用企业微信推送
在 `整体日报数据.py` 中设置：
```python
ENABLE_WECOM_PUSH = False  # 禁用企业微信推送
```

### 方案三：使用其他通知方式
1. 邮件通知
2. 短信通知
3. 其他即时通讯工具

## 📊 当前状态

- ✅ 报告生成：正常
- ✅ EdgeOne部署：正常
- ✅ Web报告访问：正常
- ❌ 企业微信推送：异常

## 🔧 临时解决方案

已添加企业微信推送开关控制：

```python
# 企业微信推送开关 - 当服务器配置有问题时可以暂时禁用
ENABLE_WECOM_PUSH = True  # 设置为False可以禁用企业微信推送
```

**使用方法**：
1. 将 `ENABLE_WECOM_PUSH` 设置为 `False` 可以暂时禁用企业微信推送
2. 报告仍然会正常生成和部署到EdgeOne
3. 可以通过Web链接访问报告：`https://edge.haierht.cn/`

## 📞 联系信息

如需修复服务器端配置，请联系：
- 服务器地址：212.64.57.87:5001
- 服务器管理员

## 📝 更新记录

- 2025-08-04：问题诊断完成
- 2025-08-04：添加推送开关控制
- 2025-08-04：创建诊断报告 